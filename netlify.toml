#------------------
# Build Settings
#------------------

[build]
  command = "hugo --gc --minify -b $URL"
  publish = "public"

[build.environment]
  HUGO_VERSION = "0.152.2"
  HUGO_EXTENDED = "true"
  NETLIFY_BUILD_IMAGE = "noble"
  HUGO_ENV = "production"
  NODE_ENV = "production"
  TZ = "CET"
  HUGO_ENABLEGITINFO = "false"
  NETLIFY_IMAGE_CDN = "true"
  GIT_DEPTH = "1"

[context.production.environment]
  HUGO_VERSION ="0.152.2"
  HUGO_ENV = "production"

[context.deploy-preview.environment]
  HUGO_VERSION ="0.152.2"

#------------------
# Headers Configuration
#------------------
# Global Security Headers
[[headers]]
for = "/*"
[headers.values]
Permissions-Policy = "accelerometer=(), camera=(), geolocation=(), gyroscope=(), magnetometer=(), microphone=(), payment=(), usb=()"
Referrer-Policy = "strict-origin-when-cross-origin"
Strict-Transport-Security = "max-age=31536000; includeSubDomains; preload"
X-Content-Type-Options = "nosniff"
X-Frame-Options = "SAMEORIGIN"
X-XSS-Protection = "1; mode=block"

# Static Assets Caching (1 year cache for immutable assets)
[[headers]]
for = "/*.{jpg,jpeg,gif,png,webp,avif,css,js,svg,woff,woff2}"
[headers.values]
Cache-Control = "public, max-age=31536000, immutable"
Netlify-CDN-Cache-Control = "public, s-maxage=31536000, stale-while-revalidate=86400"

# Document Caching (1 hour browser, 2 weeks CDN)
[[headers]]
for = "/*.{html,xml,json}"
[headers.values]
Cache-Control = "public, max-age=3600"
Netlify-CDN-Cache-Control = "public, s-maxage=1209600, stale-while-revalidate=86400, durable"

#------------------
# Redirects and Image Processing
#------------------
# Image Optimization - Route images through Netlify Image CDN
[[redirects]]
from = "/*.{jpg,jpeg,gif,png,webp,avif}"
to = "/.netlify/images?url=/:splat"
status = 200
force = true
